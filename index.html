<!DOCTYPE html><html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Кто ты в летнем лагере? — ШАГАЙ ДОМА</title>
<style>
  :root{--ink:#3a2f2f;--accent:#b22222;--paper:#fff8e6;--blue:#1f4a7f}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    background:
      url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAABa0lEQVRYR+2WPU4DMQxFP7RykBBGqI5oOwiUUN4nHBhQsW8EhRCKn0kz0gUwTTtCjFDy2+TgfL2t1n/3b3yMzueANZbABQkgDc6DkHfg+T5XEtW0CqoA9TkKEB8QgsDTR9HUBioDYHqKMUSxV8wHd9ySx13cTHmP9LQIbUeV0sANXIggGqIMHNhCObVWADMYf0QImxq9wBGyIpUV1Bo+5O6EBryrtpApDL6vlIMvgnQXhe+ACaBS8C1YDO+AyoCh2FNsAZ43nF5QHXgVrwD+i8xGeUrrQ+rmABlg6jQwGpjD88U10Af0YO0+KUnQXikAH2EEXSgApC4BLbAE6gBESbtD7kGgJTkVR0gwK5oaPfF+XLO19NccM+mJvU6MHVRo2EM5EMQvMbdoLMp8oUNPlzGckILatK62ziYB5ra+c+OfgAKxThXH2SlZzAAAAAElFTkSuQmCC') repeat,
      radial-gradient(1200px 600px at top left, #fff6d8 0%, #fffaf0 35%, #fff 60%) fixed;
    font-family: system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
  }
  .page{max-width:860px;margin:24px auto;padding:20px;background:var(--paper);border:5px double var(--accent);border-radius:18px;box-shadow:0 30px 60px rgba(0,0,0,.15);position:relative;perspective:1200px}
  /* Intro overlay */
  .intro{display:flex;justify-content:center;align-items:center;cursor:pointer}
  .intro img{max-width:100%;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.2);transition:transform .25s}
  .intro img:hover{transform:scale(1.02)}
  #quizSection{display:none}
  h1{margin:0 0 8px;text-align:center;color:var(--accent)}
  .card{background:linear-gradient(#fffef7,#fffaf0);border:2px solid #e7d9b6;border-radius:16px;padding:18px 18px 22px;transform-origin:left center;transform-style:preserve-3d;transition:transform .7s cubic-bezier(.2,.7,.2,1), opacity .4s;box-shadow:0 10px 24px rgba(0,0,0,.08);position:relative;z-index:1}
  .flip{transform:rotateY(-12deg)}
  .nav{display:flex;align-items:center;gap:12px;margin-top:14px}
  .progress{height:10px;background:#f1e6c8;border-radius:999px;overflow:hidden;flex:1;border:1px solid #e7d9b6}
  .bar{height:100%;width:0;background:linear-gradient(90deg,var(--accent),#ff7a59);transition:width .5s}
  #qnum{font-size:12px;text-transform:uppercase;color:#5c6b7a;margin:6px 0}
  #question{font-size:22px;margin:6px 0 12px}
  #answers{display:grid;gap:10px}
  @media(min-width:700px){#answers{grid-template-columns:1fr 1fr}}
  .answer{display:block;width:100%;text-align:left;padding:12px 14px;border:2px dashed var(--blue);border-radius:12px;background:#fdf8ea;cursor:pointer;transition:background .2s,transform .05s;pointer-events:auto}
  .answer:hover{background:#fff2c7}
  .answer.selected{outline:3px solid var(--accent)}
  #nextBtn{margin-top:12px;background:var(--accent);color:#fff;border:none;border-radius:12px;padding:10px 16px;font-weight:700;cursor:pointer}
  #nextBtn:disabled{opacity:.6;cursor:not-allowed}
  #result{display:none;text-align:center}
  /* Переключатель */
  .switch{position:relative;display:inline-block;width:46px;height:26px}
  .switch input{opacity:0;width:0;height:0}
  .slider{position:absolute;cursor:pointer;inset:0;background:#cbd5e1;border-radius:999px;transition:.2s}
  .slider:before{position:absolute;content:"";height:20px;width:20px;left:3px;top:3px;background:white;border-radius:50%;transition:.2s;box-shadow:0 1px 3px rgba(0,0,0,.25)}
  .switch input:checked + .slider{background:#f59e0b}
  .switch input:checked + .slider:before{transform:translateX(20px)}/* Тёплое свечение и ночной режим */ .camp-on{position:relative} .camp-on::before{content:"";position:absolute;inset:-10%;pointer-events:none;z-index:0;background: radial-gradient(60% 40% at 50% 100%, rgba(255,160,64,.28) 0%, rgba(255,120,40,.18) 35%, rgba(255,90,20,.08) 55%, rgba(0,0,0,0) 70%);animation:glow 2.4s ease-in-out infinite alternate} @keyframes glow{from{filter:brightness(1)} to{filter:brightness(1.06)}} .night{filter:brightness(.95) saturate(1.02)} .sparks{z-index:0}

.badge-wrap{margin:18px auto 8px;width:170px;height:170px;position:relative} </style>

</head>
<body>
<div class="page">
    <div class="intro" id="intro">
    <img src="intro.png" alt="Нажмите, чтобы начать тест" />
  </div>  <div id="quizSection" style="position:relative;">
    <canvas id="sparks" class="sparks" style="position:absolute; inset:0; pointer-events:none; display:none;"></canvas>
    <h1>Кто ты в летнем лагере?</h1>
    <div class="camp-toggle" style="display:flex;align-items:center;gap:10px;justify-content:center;margin:8px 0 12px">
      <label class="switch">
        <input id="campfireSwitch" type="checkbox"/>
        <span class="slider"></span>
      </label>
      <span style="font-size:14px;color:#555">Атмосфера костра</span>
    </div>
    <section id="quiz" class="card" aria-live="polite">
      <div id="qnum"></div>
      <div id="question"></div>
      <div id="answers"></div>
      <div class="nav">
        <div class="progress"><div class="bar" id="bar"></div></div>
        <button id="nextBtn" disabled>Далее</button>
      </div>
    </section>
    <section id="result"> class="campfire" style="position:relative; overflow:hidden">
      <canvas id="sparks" class="sparks" style="position:absolute; inset:0; pointer-events:none;"></canvas>
      <div class="badge-wrap" id="badgeWrap"></div>
      <h2 id="role" style="margin:6px 0 6px;color:var(--accent); position:relative; z-index:1"></h2>
      <p id="desc" style="max-width:650px;margin:0 auto;line-height:1.5; position:relative; z-index:1"></p>
      <div style="margin-top:12px; position:relative; z-index:1">
        <button id="replay" class="answer" style="border-style:solid;text-align:center">Пройти ещё раз</button>
      </div>
    </section>
  </div>
</div><script>
// Данные
const ROLES = {
  "Звезда линейки":"Всегда на первых рядах, галстук как с обложки, осанка — пример для всех. Линейка для неё — как красная дорожка.",
  "Хозяйка тихого часа":"Мастер читать под одеялом и обмениваться книжками «из-под полы». Может проспать полдня, но всё равно в курсе всех лагерных событий.",
  "Королева костра":"Гитара, песни, страшилки и разговоры «до отбоя». Вечером вокруг неё собирается весь отряд.",
  "Чемпионка турслёта":"Первая в эстафете, незаменимая в походах. Знает, как разжечь костёр, и может донести котелок даже по самому крутому склону.",
  "Карамельная королева":"Мастер карточных игр на фантики, обменов и карамельных сделок. У неё всегда есть сладости и пара секретов в запасе.",
  "Любительница компота":"Знает расписание всех приёмов пищи, дружит с дежурными по столовой и всегда находит способ взять добавку.",
  "Секретная хулиганка":"С виду пай-девочка, но только до отбоя. Может подложить зубную пасту в тапок или намылить ручку соседнего отряда."
};

const QUESTIONS = [
  {q:"Что для вас самое важное в лагере?",a:[{t:"Выглядеть на все 100",r:"Звезда линейки"},{t:"Поспать и почитать",r:"Хозяйка тихого часа"},{t:"Вечера у костра",r:"Королева костра"},{t:"Побеждать в эстафетах",r:"Чемпионка турслёта"},{t:"Обмены сладостями",r:"Карамельная королева"},{t:"Компот и вкусности",r:"Любительница компота"},{t:"Весёлые розыгрыши",r:"Секретная хулиганка"}]},
  {q:"Что вы ждёте в посылке из дома?",a:[{t:"Новую форму/заколки",r:"Звезда линейки"},{t:"Книгу или журнал",r:"Хозяйка тихого часа"},{t:"Фонарик и батарейки",r:"Королева костра"},{t:"Кроссовки для эстафет",r:"Чемпионка турслёта"},{t:"Пакет карамелек",r:"Карамельная королева"},{t:"Домашнее варенье",r:"Любительница компота"},{t:"Шуточную открытку",r:"Секретная хулиганка"}]},
  {q:"Ваш любимый момент лагерного дня:",a:[{t:"Торжественная линейка",r:"Звезда линейки"},{t:"Тихий час",r:"Хозяйка тихого часа"},{t:"Посиделки у костра",r:"Королева костра"},{t:"Спортивные соревнования",r:"Чемпионка турслёта"},{t:"Обмен фантиками",r:"Карамельная королева"},{t:"Обед/полдник",r:"Любительница компота"},{t:"Время после отбоя",r:"Секретная хулиганка"}]},
  {q:"Свободный вечер — что выберете?",a:[{t:"Подготовить форму на завтра",r:"Звезда линейки"},{t:"Досмотреть книжку/подремать",r:"Хозяйка тихого часа"},{t:"Придумать песню/историю",r:"Королева костра"},{t:"Потренироваться к стартам",r:"Чемпионка турслёта"},{t:"Разменять фантики на карамельки",r:"Карамельная королева"},{t:"Заглянуть на кухню за добавкой",r:"Любительница компота"},{t:"Организовать безобидный розыгрыш",r:"Секретная хулиганка"}]},
  {q:"Самое вкусное в столовой — это…",a:[{t:"Манная каша/котлета с пюре",r:"Звезда линейки"},{t:"Булочка к чаю",r:"Хозяйка тихого часа"},{t:"Горячий чай (даже если из столовой)",r:"Королева костра"},{t:"Макароны с тушёнкой",r:"Чемпионка турслёта"},{t:"Шоколадка из обмена",r:"Карамельная королева"},{t:"Компот или кисель",r:"Любительница компота"},{t:"Всё подряд, лишь бы весело",r:"Секретная хулиганка"}]},
  {q:"Дождливый день в лагере — ваш выбор:",a:[{t:"Навести лоск: причёска/галстук",r:"Звезда линейки"},{t:"Плед и книга под окно",r:"Хозяйка тихого часа"},{t:"Петь под гитару в корпусе",r:"Королева костра"},{t:"Тренировка в спортзале",r:"Чемпионка турслёта"},{t:"Обмен сладостями/настолки",r:"Карамельная королева"},{t:"Чай с печеньем и компот",r:"Любительница компота"},{t:"Организовать квест-розыгрыш",r:"Секретная хулиганка"}]},
  {q:"Что вы чаще всего теряли в лагере?",a:[{t:"Значок/галстук",r:"Звезда линейки"},{t:"Закладку для книги",r:"Хозяйка тихого часа"},{t:"Фонарик",r:"Королева костра"},{t:"Спортивную повязку",r:"Чемпионка турслёта"},{t:"Шоколадку (её «выиграли»)",r:"Карамельная королева"},{t:"Стакан для компота",r:"Любительница компота"},{t:"Ключ от тумбочки (иногда)",r:"Секретная хулиганка"}]},
  {q:"Объявили «Смотр песни и строя». Ваша реакция?",a:[{t:"Выпрямить спину и вперёд!",r:"Звезда линейки"},{t:"Поспать полчасика до репетиции",r:"Хозяйка тихого часа"},{t:"Придумать речёвку у костра",r:"Королева костра"},{t:"Разминка и чёткий шаг",r:"Чемпионка турслёта"},{t:"Договориться о карамельках за крик команды",r:"Карамельная королева"},{t:"После смотра — в столовую!",r:"Любительница компота"},{t:"Подложить свисток вожатой (шутка)",r:"Секретная хулиганка"}]}
];

// Логика + вау-эффекты
let idx=0, scores=Object.create(null), picked=null;
const intro = document.getElementById('intro');
const quizSection = document.getElementById('quizSection');
const quiz = document.getElementById('quiz');
const qnumEl=document.getElementById('qnum'), qEl=document.getElementById('question');
const answersEl=document.getElementById('answers');
const nextBtn=document.getElementById('nextBtn');
const bar=document.getElementById('bar');

function renderQ(){
  const total=QUESTIONS.length, q=QUESTIONS[idx];
  qnumEl.textContent=`Вопрос ${idx+1} из ${total}`;
  qEl.textContent=q.q;
  answersEl.innerHTML='';
  picked=null; nextBtn.disabled=true;
  quiz.classList.remove('flip');
  setTimeout(()=>quiz.classList.add('flip'),20);
  q.a.forEach((opt,i)=>{
    const b=document.createElement('button');
    b.type='button'; b.className='answer'; b.textContent=opt.t; b.dataset.role=opt.r;
    b.style.opacity=0; b.style.transform='translateY(6px)';
    setTimeout(()=>{b.style.transition='opacity .25s ease, transform .25s ease'; b.style.opacity=1; b.style.transform='translateY(0)';}, 60*i);
    answersEl.appendChild(b);
  });
  // Делегирование кликов — устойчиво во всех браузерах
  answersEl.onclick = (e)=>{
    const btn = e.target.closest('.answer');
    if(!btn) return;
    picked = { t: btn.textContent, r: btn.dataset.role };
    nextBtn.disabled = false;
    answersEl.querySelectorAll('.answer').forEach(el=>el.classList.remove('selected'));
    btn.classList.add('selected');
  };
  bar.style.width = ((idx)/total*100)+'%';
} из ${total}`;
  qEl.textContent=q.q;
  answersEl.innerHTML='';
  picked=null; nextBtn.disabled=true;
  quiz.classList.remove('flip');
  setTimeout(()=>quiz.classList.add('flip'),20);
  q.a.forEach((opt,i)=>{
    const b=document.createElement('button');
    b.type='button'; b.className='answer'; b.textContent=opt.t;
    b.style.opacity=0; b.style.transform='translateY(6px)';
    setTimeout(()=>{b.style.transition='opacity .25s ease, transform .25s ease'; b.style.opacity=1; b.style.transform='translateY(0)';}, 60*i);
    b.addEventListener('click',()=>{
      picked=opt; nextBtn.disabled=false;
      document.querySelectorAll('.answer').forEach(el=>el.classList.remove('selected'));
      b.classList.add('selected');
    });
    answersEl.appendChild(b);
  });
  bar.style.width = ((idx)/total*100)+'%';
}

nextBtn.addEventListener('click',()=>{
  if(!picked) return;
  scores[picked.r]=(scores[picked.r]||0)+1;
  idx++;
  if(idx<QUESTIONS.length){ renderQ(); }
  else { showResult(); }
});

function winner(){ return Object.keys(scores).reduce((a,b)=> scores[a]>scores[b]?a:b); }

function showResult(){
  quiz.style.display='none';
  const res=document.getElementById('result'); res.style.display='block';
  const w=winner();
  document.getElementById('role').textContent=w;
  document.getElementById('desc').textContent=ROLES[w];
  drawBadge(w);
  bar.style.width='100%';
  /* эффекты зависят от переключателя */ bugle();
}

// Значок (SVG)
function drawBadge(role){
  const wrap=document.getElementById('badgeWrap'); wrap.innerHTML='';
  const svgNS='http://www.w3.org/2000/svg';
  const svg=document.createElementNS(svgNS,'svg'); svg.setAttribute('viewBox','0 0 200 200'); svg.style.width='100%'; svg.style.height='100%';
  const defs=document.createElementNS(svgNS,'defs');
  const grad=document.createElementNS(svgNS,'radialGradient'); grad.id='g1';
  grad.innerHTML='<stop offset="0%" stop-color="#fff6d6"/><stop offset="60%" stop-color="#f1c16d"/><stop offset="100%" stop-color="#c58a21"/>';
  defs.appendChild(grad); svg.appendChild(defs);
  const circle=document.createElementNS(svgNS,'circle'); circle.setAttribute('cx','100'); circle.setAttribute('cy','100'); circle.setAttribute('r','78'); circle.setAttribute('fill','url(#g1)'); circle.setAttribute('stroke','#8a5a12'); circle.setAttribute('stroke-width','6'); svg.appendChild(circle);
  const ribbon=document.createElementNS(svgNS,'path'); ribbon.setAttribute('d','M60 170 L100 130 L140 170 L120 170 L100 150 L80 170 Z'); ribbon.setAttribute('fill','var(--accent)'); ribbon.setAttribute('opacity','.9'); svg.appendChild(ribbon);
  const icon=document.createElementNS(svgNS,'text'); icon.setAttribute('x','100'); icon.setAttribute('y','105'); icon.setAttribute('text-anchor','middle'); icon.setAttribute('dominant-baseline','central'); icon.setAttribute('font-size','48'); icon.setAttribute('font-weight','700'); icon.setAttribute('fill','#612e0a'); icon.textContent=iconFor(role); svg.appendChild(icon);
  const t=document.createElementNS(svgNS,'text'); t.setAttribute('x','100'); t.setAttribute('y','188'); t.setAttribute('text-anchor','middle'); t.setAttribute('font-size','12'); t.setAttribute('fill','#5a4635'); t.textContent=role; svg.appendChild(t);
  wrap.appendChild(svg);
}
function iconFor(role){
  switch(role){
    case 'Звезда линейки': return '★';
    case 'Хозяйка тихого часа': return '☕';
    case 'Королева костра': return '🔥';
    case 'Чемпионка турслёта': return '🏅';
    case 'Карамельная королева': return '🍬';
    case 'Любительница компота': return '🥤';
    case 'Секретная хулиганка': return '😼';
    default: return '⭐';
  }
}

// Атмосфера костра: искры + ночной фон + потрескивание
let sparksCanvas=null, spCtx=null, spRAF=null, SP=[], sparksRunning=false, fireGain=null, audioCtx=null;
const campSwitchEl = document.getElementById('campfireSwitch');
const pageEl = document.querySelector('.page');

function enableCampfire(){
  // визуал
  pageEl.classList.add('camp-on','night');
  const sc = document.getElementById('sparks'); sc.style.display='block';
  startSparks();
  // звук
  startCampfireSound();
}
function disableCampfire(){
  pageEl.classList.remove('camp-on','night');
  const sc = document.getElementById('sparks'); sc.style.display='none';
  stopSparks(); stopCampfireSound();
}

campSwitchEl?.addEventListener('change', (e)=>{
  if(e.target.checked) enableCampfire(); else disableCampfire();
});

function startSparks(){
  if(sparksRunning) return; sparksRunning=true;
  sparksCanvas = document.getElementById('sparks'); spCtx = sparksCanvas.getContext('2d');
  const resize=()=>{ const r = document.getElementById('quizSection').getBoundingClientRect(); sparksCanvas.width = r.width; sparksCanvas.height = r.height; };
  resize(); addEventListener('resize', resize);
  const N=90; SP = Array.from({length:N},()=>makeSpark());
  function makeSpark(){ return { x: Math.random()*sparksCanvas.width, y: sparksCanvas.height + Math.random()*80, vy: 0.6 + Math.random()*1.2, size: 1 + Math.random()*2, life: 1 + Math.random()*2, hue: 25 + Math.random()*20, a: .5 + Math.random()*.5 }; }
  function loop(){
    if(!sparksRunning) return;
    spCtx.clearRect(0,0,sparksCanvas.width,sparksCanvas.height);
    SP.forEach(p=>{ p.y -= p.vy; p.a -= 0.008; if(p.a<=0 || p.y < -10){ Object.assign(p, { x: Math.random()*sparksCanvas.width, y: sparksCanvas.height + Math.random()*60, vy: 0.6 + Math.random()*1.2, size: 1 + Math.random()*2, life: 1 + Math.random()*2, hue: 25 + Math.random()*20, a: .5 + Math.random()*.5 }); }
      const g=spCtx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.size*3); g.addColorStop(0,`hsla(${p.hue},90%,60%,${p.a})`); g.addColorStop(1,'hsla(25,90%,50%,0)'); spCtx.fillStyle=g; spCtx.beginPath(); spCtx.arc(p.x,p.y,p.size*3,0,Math.PI*2); spCtx.fill(); });
    spRAF = requestAnimationFrame(loop);
  }
  loop();
}
function stopSparks(){ if(spRAF) cancelAnimationFrame(spRAF); sparksRunning=false; }

function ac(){ return audioCtx || (audioCtx = new (window.AudioContext||window.webkitAudioContext)()); }
function startCampfireSound(){
  const ctx = ac();
  const rate = ctx.sampleRate; const len = rate * 3; // 3 сек буфер, будет в петлю
  const buffer = ctx.createBuffer(1, len, rate); const data = buffer.getChannelData(0);
  let lastOut = 0; for(let i=0;i<len;i++){ // розовый шум + случайные щелчки
    const white = Math.random()*2-1; lastOut = 0.98*lastOut + 0.02*white; data[i]=lastOut*0.5; if(Math.random()<0.002) data[i]+= (Math.random()*2-1)*0.9;
  }
  const src = ctx.createBufferSource(); src.buffer = buffer; src.loop = true;
  fireGain = ctx.createGain(); fireGain.gain.value = 0.18; // тихо
  src.connect(fireGain).connect(ctx.destination); src.start();
  // сохраняем, чтобы можно было стопнуть
  startCampfireSound._src = src;
}
function stopCampfireSound(){ try{ startCampfireSound._src?.stop(); }catch(e){} if(fireGain){ fireGain.disconnect(); fireGain=null; } }

// Звуки (WebAudio) (WebAudio)
let AC; function ac(){ return AC || (AC = new (window.AudioContext||window.webkitAudioContext)()); }
function bugle(){ const ctx=ac(); const now=ctx.currentTime; [523.25,659.25,783.99,1046.5].forEach((f,i)=>{ const o=ctx.createOscillator(), g=ctx.createGain(); o.type='square'; o.frequency.value=f; o.connect(g); g.connect(ctx.destination); const t=now+i*0.18; o.start(t); g.gain.setValueAtTime(.0001,t); g.gain.exponentialRampToValueAtTime(.35,t+.02); g.gain.exponentialRampToValueAtTime(.0001,t+.16); o.stop(t+.18); }); }

// Кнопки
 document.getElementById('replay').addEventListener('click',()=>location.reload());

// Старт по клику на интро
intro.addEventListener('click',()=>{ intro.style.display='none'; quizSection.style.display='block'; renderQ(); });
</script></body>
</html>
