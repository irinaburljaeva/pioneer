<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>–ö—Ç–æ —Ç—ã –≤ –ª–µ—Ç–Ω–µ–º –ª–∞–≥–µ—Ä–µ? ‚Äî –®–ê–ì–ê–ô –î–û–ú–ê</title>
<style>
  :root{ --ink:#2e2623; --accent:#b22222; --paper:#fff8e6; --blue:#1f4a7f; --night-dim:rgba(10,12,18,.45); --navH:64px; }
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    background:radial-gradient(1200px 600px at top left,#fff6d8 0%,#fffaf0 35%,#fff 60%) fixed;
    font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial,sans-serif;
  }
  body.camp-night::before{content:"";position:fixed;inset:0;z-index:0;pointer-events:none;background:var(--night-dim)}
  .fx-layer{position:fixed;inset:0;z-index:1;pointer-events:none;display:none;width:100%;height:100%}

  .page{
    max-width:900px;margin:20px auto;padding:20px;position:relative;z-index:2;background:var(--paper);border-radius:18px;overflow:hidden;
    box-shadow:0 30px 60px rgba(0,0,0,.14), inset 0 0 0 2px #e7d9b6, 0 0 0 6px rgba(255,255,255,.7), inset 0 0 0 8px #f4ecd1;
  }

  .topbar{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
  h1{margin:0;color:var(--accent);font-size:24px}
  .flames{display:flex;gap:6px;align-items:center}
  .flame{font-size:18px;opacity:.25;transition:opacity .25s,transform .25s}
  .flame.on{opacity:1;transform:translateY(-2px)}

  .camp-toggle{display:flex;align-items:center;gap:10px;justify-content:center;margin:8px 0 12px}
  .switch{position:relative;display:inline-block;width:50px;height:28px}
  .switch input{opacity:0;width:0;height:0}
  .slider{position:absolute;cursor:pointer;inset:0;background:#cbd5e1;border-radius:999px;transition:.2s}
  .slider:before{position:absolute;content:"";height:22px;width:22px;left:3px;top:3px;background:#fff;border-radius:50%;transition:.2s;box-shadow:0 1px 3px rgba(0,0,0,.25)}
  .switch input:checked + .slider{background:#f59e0b}
  .switch input:checked + .slider:before{transform:translateX(22px)}

  .card{position:relative;z-index:2;background:linear-gradient(#fffef7,#fffaf0);
        border:1px solid #e8e0c7;border-radius:16px;padding:18px;box-shadow:0 10px 24px rgba(0,0,0,.08)}
  .stage{position:relative;min-height:340px}

  /* ‚Äî‚Äî –∏–Ω—Ç—Ä–æ (—Ç–æ–ª—å–∫–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞) ‚Äî‚Äî */
  .intro-cover{
    position:absolute; inset:0; z-index:6; display:flex; align-items:center; justify-content:center;
    background:linear-gradient(180deg,#fffdf5,#fff7e6); cursor:pointer; transition:opacity .35s ease;
    padding:10px; touch-action:manipulation;
  }
  /* –ø—Ä–∏ –∏–Ω—Ç—Ä–æ —É–≤–µ–ª–∏—á–∏–º –≤—ã—Å–æ—Ç—É, —á—Ç–æ–±—ã –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Ç–æ—á–Ω–æ –≤–ª–µ–∑–ª–∞ */
  body.prestart .stage{ min-height:min(82vh, 860px); }

  .intro-cover img{
    max-width:100%; max-height:100%;
    width:auto; height:auto; object-fit:contain;
    border-radius:14px; box-shadow:0 12px 30px rgba(0,0,0,.18);
    user-select:none; -webkit-user-drag:none; pointer-events:none;
  }
  .intro-cover.fade-out{opacity:0;pointer-events:none}

  /* —Å–ª–∞–π–¥—ã */
  .slide{position:absolute;inset:0;opacity:0;transform:translateX(45px) rotateY(-4deg);
         transition:transform .5s cubic-bezier(.2,.7,.2,1),opacity .5s}
  .slide.active{opacity:1;transform:translateX(0) rotateY(0)}
  .slide.out-left{opacity:0;transform:translateX(-45px) rotateY(6deg)}
  .slide.in-right{opacity:0;transform:translateX(45px) rotateY(-6deg)}
  .slide.in-right.active{opacity:1;transform:translateX(0) rotateY(0)}

  #qnum{font-size:12px;text-transform:uppercase;color:#5c6b7a;margin:6px 0}
  #question{font-size:22px;margin:6px 0 12px}
  .answers-wrap{padding-right:4px;padding-bottom:calc(var(--navH) + 16px);max-height:65vh;overflow:auto}
  .answers-grid{display:grid;gap:10px;grid-template-columns:repeat(auto-fit,minmax(220px,1fr))}
  .answer{display:block;width:100%;text-align:left;padding:12px 14px;border:2px dashed var(--blue);
          border-radius:12px;background:#fdf8ea;cursor:pointer;transition:background .15s,box-shadow .2s; box-shadow:0 2px 0 rgba(0,0,0,.06)}
  .answer:hover{background:#fff2c7;box-shadow:0 4px 12px rgba(0,0,0,.07)}
  .answer.selected{outline:3px solid var(--accent)}

  .nav{position:sticky;bottom:0;z-index:5;display:flex;justify-content:flex-end;align-items:center;gap:12px;
       padding:10px 6px calc(10px + env(safe-area-inset-bottom));
       background:linear-gradient(180deg,rgba(255,255,255,0),#fffaf0 40%);border-bottom-left-radius:14px;border-bottom-right-radius:14px}
  #nextBtn{background:var(--accent);color:#fff;border:none;border-radius:12px;padding:10px 18px;font-weight:700;cursor:pointer;
           box-shadow:0 6px 18px rgba(178,34,34,.25)}
  #nextBtn:disabled{opacity:.6;box-shadow:none;cursor:not-allowed}

  #result{display:none;text-align:center;position:relative;z-index:2}
  .badge-wrap{margin:18px auto 8px;width:170px;height:170px;position:relative}
  .cta{display:inline-block;margin-top:16px;padding:12px 24px;background:#b22222;color:#fff;border-radius:24px;text-decoration:none;font-weight:700}

  /* —Å–ø—Ä—è—Ç–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–æ —Å—Ç–∞—Ä—Ç–∞ */
  body.prestart .topbar,
  body.prestart .camp-toggle,
  body.prestart #nav { display:none !important; }
</style>
</head>
<body class="prestart">

<canvas id="fireCanvas" class="fx-layer"></canvas>
<canvas id="sparksCanvas" class="fx-layer"></canvas>

<div class="page">
  <div class="topbar">
    <h1>–ö—Ç–æ —Ç—ã –≤ –ª–µ—Ç–Ω–µ–º –ª–∞–≥–µ—Ä–µ?</h1>
    <div class="flames" id="flames" aria-label="–ü—Ä–æ–≥—Ä–µ—Å—Å">
      <span class="flame">üî•</span><span class="flame">üî•</span><span class="flame">üî•</span><span class="flame">üî•</span>
      <span class="flame">üî•</span><span class="flame">üî•</span><span class="flame">üî•</span><span class="flame">üî•</span>
    </div>
  </div>

  <div class="camp-toggle">
    <label class="switch">
      <input id="campfireSwitch" type="checkbox" />
      <span class="slider"></span>
    </label>
    <span style="font-size:14px;color:#555">–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞ –∫–æ—Å—Ç—Ä–∞</span>
  </div>

  <section id="quiz" class="card" aria-live="polite">
    <!-- –∏–Ω—Ç—Ä–æ -->
    <div class="intro-cover" id="introCover" role="button" tabindex="0" aria-label="–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç">
      <img src="intro.png" alt="–õ–µ—Ç–Ω–∏–π –ª–∞–≥–µ—Ä—å ‚Äî –Ω–∞—á–Ω–∏—Ç–µ —Ç–µ—Å—Ç" />
    </div>

    <div class="stage" id="stage"></div>
    <div class="nav" id="nav"><button id="nextBtn" disabled>–î–∞–ª–µ–µ</button></div>
  </section>

  <section id="result" class="card" style="display:none;">
    <div class="badge-wrap" id="badgeWrap"></div>
    <h2 id="role" style="margin:6px 0 6px;color:var(--accent)"></h2>
    <p id="desc" style="max-width:650px;margin:0 auto 14px;line-height:1.5"></p>

    <div style="margin:12px auto 8px;max-width:680px;text-align:center;">
      <p style="margin:0 0 8px;">–ì–æ—Ç–æ–≤—ã –ø—Ä–æ–∂–∏—Ç—å <strong>–≤–∞—à–µ –ª–µ—Ç–æ –º–µ—á—Ç—ã</strong> –≤ –¥—É—Ö–µ –ø–∏–æ–Ω–µ—Ä–ª–∞–≥–µ—Ä—è ‚Äî –ø—Ä—è–º–æ –∏–∑ –¥–æ–º–∞?</p>
      <ul style="text-align:left;display:inline-block;margin:0;padding-left:18px;line-height:1.5">
        <li><strong>–®–∞–≥–∞—Ç–µ–ª—å–Ω—ã–µ –¥–∏—Å–∫–æ—Ç–µ–∫–∏</strong> –∫–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –ª—é–±–∏–º–∞—è –º—É–∑—ã–∫–∞ –∏ –ª—ë–≥–∫–∏–µ —Ä–∏—Ç–º—ã –≤–º–µ—Å—Ç–æ —Å–∫—É—á–Ω—ã—Ö —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫</li>
        <li>–õ–∞–≥–µ—Ä–Ω—ã–µ –∏–≥—Ä—ã, –¥—É—à–µ–≤–Ω—ã–µ –ø–æ—Å–∏–¥–µ–ª–∫–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–º–∞–Ω–¥—ã</li>
        <li>¬´–õ–∞–≥–µ—Ä–Ω–æ–µ –º–µ–Ω—é¬ª: –≤–∫—É—Å–Ω–æ, —Å—ã—Ç–Ω–æ –∏ –±–µ–∑ —á—É–≤—Å—Ç–≤–∞ –≤–∏–Ω—ã</li>
        <li><strong>–û–Ω–ª–∞–π–Ω-–ª–∞–≥–µ—Ä—å:</strong> –≤—Å—ë –ø—Ä–æ—Ö–æ–¥–∏—Ç –¥–∏—Å—Ç–∞–Ω—Ü–∏–æ–Ω–Ω–æ ‚Äî –∏–∑ –¥–æ–º–∞ –≤—ã—Ö–æ–¥–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ</li>
      </ul>
      <p style="margin:12px 0 0;">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Ç–µ—Å—å –∫ –∏–Ω—Ç–µ–Ω—Å–∏–≤—É ¬´–õ–µ—Ç–Ω–∏–π –ª–∞–≥–µ—Ä—å¬ª –æ—Ç –®–ê–ì–ê–ô –î–û–ú–ê ‚Äî <em>–≤–∞—à–µ –ª–µ—Ç–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –∑–¥–µ—Å—å!</em></p>
      <p><a class="cta" href="https://walk-walk.ru/summer_camp?utm_source=website&utm_medium=test&utm_campaign=test" target="_blank" rel="noopener">–•–æ—á—É –≤ –æ—Ç—Ä—è–¥!</a></p>
    </div>

    <div style="margin-top:12px"><button id="replay" class="answer" style="border-style:solid;text-align:center">–ü—Ä–æ–π—Ç–∏ –µ—â—ë —Ä–∞–∑</button></div>
  </section>
</div>

<audio id="fireAudio" src="fire.mp3" loop></audio>

<script>
'use strict';

/* ===== –¥–∞–Ω–Ω—ã–µ ===== */
const ROLES={
  "–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã":"–í—Å–µ–≥–¥–∞ –Ω–∞ –≤–∏–¥—É, —É—Ö–æ–∂–µ–Ω–∞, –ª—é–±–∏—Ç —Å—Ü–µ–Ω—É –∏ –ª–∏–Ω–µ–π–∫–∏ ‚Äî —Ü–µ–Ω—Ç—Ä –ø—Ä–∏—Ç—è–∂–µ–Ω–∏—è –ª–∞–≥–µ—Ä—è.",
  "–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞":"–ì–ª–∞–≤–Ω–∞—è –ø–æ —Å—Ç–æ–ª–æ–≤–æ–π –∏ –¥—É—à–µ–≤–Ω—ã–º —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º. –ó–Ω–∞–µ—Ç, –≥–¥–µ –¥–æ–±–∞–≤–∫–∞ –∏ —Å –∫–µ–º —Å–∏–¥–µ—Ç—å –∑–∞ —Å—Ç–æ–ª–æ–º.",
  "–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞":"–í–µ–∑–¥–µ —É—á–∞—Å—Ç–≤—É–µ—Ç, –≤—Å—ë –æ—Ä–≥–∞–Ω–∏–∑—É–µ—Ç –∏ –ø–æ–¥–Ω–∏–º–∞–µ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ –æ—Ç—Ä—è–¥—É.",
  "–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞":"–ü–∞–π-–¥–µ–≤–æ—á–∫–∞ –¥–æ –æ—Ç–±–æ—è, –∞ –ø–æ—Ç–æ–º ‚Äî –º–∞—Å—Ç–µ—Ä –¥—Ä—É–∂–µ—Å–∫–∏—Ö —Ä–æ–∑—ã–≥—Ä—ã—à–µ–π.",
  "–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏":"–¢–∞–∫—Ç–∏–∫ –∏ —Å—Ç—Ä–∞—Ç–µ–≥. –î–∞–∂–µ —Ñ–∞–Ω—Ç–∏–∫–∏ –æ–±–º–µ–Ω–∏–≤–∞–µ—Ç —Å –≤—ã–≥–æ–¥–æ–π.",
  "–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞":"–≠—Å—Ç–∞—Ñ–µ—Ç—ã, —Ç—É—Ä—Å–ª—ë—Ç, –∑–∞—Ä—è–¥–∫–∞ ‚Äî –µ—ë —Å—Ç–∏—Ö–∏—è. –ö–æ–º–∞–Ω–¥–Ω—ã–π –¥–≤–∏–≥–∞—Ç–µ–ª—å."
};
const QUESTIONS=[ /* 8√ó6 */ 
  {q:"–ß—Ç–æ —Ü–µ–Ω–Ω–æ–≥–æ –≤—ã –∂–¥—ë—Ç–µ –≤ –ø–æ—Å—ã–ª–∫–µ –∏–∑ –¥–æ–º–∞?",a:[
    {t:"–ù–æ–≤–∞—è –∫–æ—Å–º–µ—Ç–∏—á–∫–∞ –∏ –∑–∞–∫–æ–ª–∫–∏",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–ë–∞–Ω–æ—á–∫–∞ –≤–∞—Ä–µ–Ω—å—è/–≤–∫—É—Å–Ω–æ—Å—Ç–∏",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–ü–ª–∞–∫–∞—Ç—ã, —Ñ–ª–∞–∂–∫–∏, —ç–º–±–ª–µ–º—ã",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–®—É—Ç–æ—á–Ω–∞—è –æ—Ç–∫—Ä—ã—Ç–∫–∞/–∂–≤–∞—á–∫–∏",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–ö–æ–ª–æ–¥–∞ –∫–∞—Ä—Ç –∏ —Ñ–∞–Ω—Ç–∏–∫–∏",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –Ω–æ—Å–∫–∏/–±—É—Ç—ã–ª–∫–∞",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–ß–µ–º –≤—ã –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ —Ö–æ—Ç–∏—Ç–µ –∑–∞–Ω–∏–º–∞—Ç—å—Å—è –≤ –ª–∞–≥–µ—Ä–µ?",a:[
    {t:"–ì–æ—Ç–æ–≤–∏—Ç—å –≤—ã—Å—Ç—É–ø–ª–µ–Ω–∏—è, –¥–µ—Ñ–∏–ª–µ",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–°–∏–¥–µ—Ç—å —É —Å—Ç–æ–ª–æ–≤–æ–π —Å –ø–æ–¥—Ä—É–∂–∫–∞–º–∏",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–û—Ä–≥–∞–Ω–∏–∑–æ–≤—ã–≤–∞—Ç—å –∫–æ–Ω–∫—É—Ä—Å—ã/–∫–≤–µ—Å—Ç—ã",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–ü—Ä–∏–¥—É–º—ã–≤–∞—Ç—å –±–µ–∑–æ–±–∏–¥–Ω—ã–µ —à–∞–ª–æ—Å—Ç–∏",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–ò–≥—Ä–∞—Ç—å –≤ –∫–∞—Ä—Ç—ã –¥–æ –æ—Ç–±–æ—è",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–ë–µ–≥–∞—Ç—å —ç—Å—Ç–∞—Ñ–µ—Ç—ã –∏ –∏–≥—Ä–∞—Ç—å –≤ –≤–æ–ª–µ–π–±–æ–ª",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–õ—é–±–∏–º–æ–µ –±–ª—é–¥–æ –≤ —Å—Ç–æ–ª–æ–≤–æ–π:",a:[
    {t:"–ö–æ—Ç–ª–µ—Ç–∞ —Å –ø—é—Ä–µ",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–ö–æ–º–ø–æ—Ç (–∏ –¥–æ–±–∞–≤–∫—É!)",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–û–ª–∏–≤—å–µ/—Å–∞–ª–∞—Ç–∏–∫–∏ –Ω–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–ë—É–ª–æ—á–∫–∞ –∫ —á–∞—é ¬´—É–∫—Ä–∞–¥–∫–æ–π¬ª",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–®–æ–∫–æ–ª–∞–¥–∫–∞ –∏–∑ –æ–±–º–µ–Ω–∞",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–ú–∞–∫–∞—Ä–æ–Ω—ã –ø–æ-—Ñ–ª–æ—Ç—Å–∫–∏",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–ù–æ—á—å –≤ –ª–∞–≥–µ—Ä–µ ‚Äî —ç—Ç–æ‚Ä¶",a:[
    {t:"–ö—Ä–∞—Å–∏–≤—ã–µ –ø–∏–∂–∞–º—ã –∏ —Å–æ–Ω",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–¢–∏—Ö–∏–π —á–∞–π —Å –∫–æ–º–ø–æ—Ç–æ–º –Ω–∞ –∫—É—Ö–Ω–µ",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–û–±—Å—É–∂–¥–µ–Ω–∏–µ –ø–ª–∞–Ω–æ–≤ –æ—Ç—Ä—è–¥–∞",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–°—Ç—Ä–∞—à–∏–ª–∫–∏ –∏ –ø–æ—Ö–æ–¥—ã –∑–∞ –≤–∫—É—Å–Ω—è—à–∫–∞–º–∏",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–ü–∞—Ä—Ç–∏—è –≤ –∫–∞—Ä—Ç—ã –¥–æ –æ—Ç–±–æ—è",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–†–∞–Ω–Ω—è—è –ø—Ä–æ–±–µ–∂–∫–∞ –Ω–∞ —Ä–∞—Å—Å–≤–µ—Ç–µ",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–ú–µ–¥–ª—è–∫ –Ω–∞ –¥–∏—Å–∫–æ—Ç–µ–∫–µ ‚Äî —ç—Ç–æ‚Ä¶",a:[
    {t:"–ú–æ–π –∑–≤—ë–∑–¥–Ω—ã–π —á–∞—Å",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–°–±–µ–≥–∞—Ç—å –∑–∞ –∫–æ–º–ø–æ—Ç–æ–º –∏ –≤–µ—Ä–Ω—É—Ç—å—Å—è",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–ü–æ–∑–≤–∞—Ç—å –≤—Å–µ—Ö –Ω–∞ —Ñ–ª–µ—à–º–æ–±",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–®—É—Ç–∫–∞ –Ω–∞–¥ –¥–∏–¥–∂–µ–µ–º",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–°–¥–µ–ª–∫–∞: –∫—Ç–æ —Ç–∞–Ω—Ü—É–µ—Ç ‚Äî —Ç–æ—Ç –¥–æ–ª–∂–µ–Ω —Ñ–∞–Ω—Ç–∏–∫",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–ü–µ—Ä–µ–¥—ã—à–∫–∞ –º–µ–∂–¥—É —Ç–∞–Ω—Ü–∞–º–∏",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–ï—Å–ª–∏ –±—ã –≤—ã —Å—Ç–∞–ª–∏ –≤–æ–∂–∞—Ç–æ–π, –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º‚Ä¶",a:[
    {t:"–°–¥–µ–ª–∞–ª–∞ —Ñ–æ—Ç–æ–∑–æ–Ω—É –∏ –¥–µ—Ñ–∏–ª–µ",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–ù–∞–ª–∞–¥–∏–ª–∞ —á–∞–π–Ω–æ-–∫–æ–º–ø–æ—Ç–Ω—ã–µ –ø–æ—Å–∏–¥–µ–ª–∫–∏",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–ó–∞–ø—É—Å—Ç–∏–ª–∞ –µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ —á–µ–ª–ª–µ–Ω–¥–∂–∏",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–ü—Ä–∏–¥—É–º–∞–ª–∞ –¥–æ–±—Ä—ã–µ —Ä–æ–∑—ã–≥—Ä—ã—à–∏",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–ù–∞—É—á–∏–ª–∞ –≤—Å–µ—Ö –Ω–æ–≤—ã–º –∫–∞—Ä—Ç–æ—á–Ω—ã–º —Ñ–∏—à–∫–∞–º",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–û—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–ª–∞ —Ç—É—Ä–Ω–∏—Ä –ø–æ —ç—Å—Ç–∞—Ñ–µ—Ç–∞–º",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–õ—É—á—à–∏–π —Ç—Ä–æ—Ñ–µ–π –∏–∑ –ª–∞–≥–µ—Ä—è ‚Äî —ç—Ç–æ‚Ä¶",a:[
    {t:"–§–æ—Ç–æ —Å–æ —Å—Ü–µ–Ω—ã –∏ –∑–Ω–∞—á–æ–∫",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–†–µ—Ü–µ–ø—Ç —Ñ–∏—Ä–º–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø–æ—Ç–∞",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–ì—Ä–∞–º–æ—Ç–∞ ¬´–°–∞–º—ã–π –∞–∫—Ç–∏–≤–Ω—ã–π –æ—Ç—Ä—è–¥¬ª",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–¢–∞–π–Ω–∞—è –∑–∞–ø–∏—Å–∫–∞, –Ω–∞–π–¥–µ–Ω–Ω–∞—è –Ω–æ—á—å—é",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–ü–∞—á–∫–∞ –∫–∞—Ä–∞–º–µ–ª–µ–∫, –≤—ã–∏–≥—Ä–∞–Ω–Ω–∞—è –≤ –∫–∞—Ä—Ç—ã",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–ú–µ–¥–∞–ª—å/–ø–æ–≤—è–∑–∫–∞ —á–µ–º–ø–∏–æ–Ω–∞",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]},
  {q:"–ì–¥–µ –≤–∞—à–µ –ª—é–±–∏–º–æ–µ –º–µ—Å—Ç–æ –≤ –ª–∞–≥–µ—Ä–µ?",a:[
    {t:"–°—Ü–µ–Ω–∞ –∫–ª—É–±–∞ –∏ –ª–∏–Ω–µ–π–∫–∏",r:"–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã"},
    {t:"–°—Ç–æ–ª–æ–≤–∞—è",r:"–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞"},
    {t:"–ü–ª–æ—â–∞–¥–∫–∞ –¥–ª—è –æ–±—â–∏—Ö —Å–±–æ—Ä–æ–≤",r:"–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞"},
    {t:"–¢—Ä–æ–ø–∏–Ω–∫–∞ –∫ –∫–æ—Å—Ç—Ä–æ–≤–æ–π –ø–æ–ª—è–Ω–µ",r:"–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞"},
    {t:"–°—Ç–æ–ª –¥–ª—è –∫–∞—Ä—Ç–æ—á–Ω—ã—Ö –±–∞—Ç–∞–ª–∏–π",r:"–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏"},
    {t:"–°—Ç–∞–¥–∏–æ–Ω/—Å–ø–æ—Ä—Ç–ø–ª–æ—â–∞–¥–∫–∞",r:"–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞"}]}
];

/* ===== —ç–ª–µ–º–µ–Ω—Ç—ã ===== */
const campSwitchEl=document.getElementById('campfireSwitch');
const fireCanvas=document.getElementById('fireCanvas');
const sparksCanvas=document.getElementById('sparksCanvas');
const fctx=fireCanvas.getContext('2d');
const sctx=sparksCanvas.getContext('2d');
const stage=document.getElementById('stage');
const flamesBar=document.querySelectorAll('#flames .flame');
const resultSection=document.getElementById('result');
const quizCard=document.getElementById('quiz');
const roleEl=document.getElementById('role');
const descEl=document.getElementById('desc');
const badgeWrap=document.getElementById('badgeWrap');
const replayBtn=document.getElementById('replay');
const nextBtn=document.getElementById('nextBtn');
const navEl=document.getElementById('nav');
const introCover=document.getElementById('introCover');
const fireAudio=document.getElementById('fireAudio'); // ‚Üê —Ç–µ–ø–µ—Ä—å –æ–±—ä—è–≤–ª–µ–Ω–∞ —Ç–æ–ª—å–∫–æ –û–î–ò–ù —Ä–∞–∑

let idx=0, scores=Object.create(null), picked=null;

/* —É—Ç–∏–ª–∏—Ç—ã */
function updateNavPadding(){ document.documentElement.style.setProperty('--navH',(navEl.offsetHeight||64)+'px'); }
function updateFlames(){ flamesBar.forEach((f,i)=> f.classList.toggle('on', i<idx)); }

/* —Ä–µ–Ω–¥–µ—Ä –≤–æ–ø—Ä–æ—Å–∞ */
function renderQuestion(){
  const q=QUESTIONS[idx], total=QUESTIONS.length;
  updateNavPadding(); updateFlames();
  const current=stage.querySelector('.slide.active');
  if(current){ current.classList.remove('active'); current.classList.add('out-left'); setTimeout(()=>current.remove(),500); }
  const slide=document.createElement('div');
  slide.className='slide in-right';
  slide.innerHTML=`
    <div id="qnum">–í–æ–ø—Ä–æ—Å ${idx+1} –∏–∑ ${total}</div>
    <div id="question">${q.q}</div>
    <div class="answers-wrap"><div id="answers" class="answers-grid">
      ${q.a.map(a=>`<button class="answer" data-role="${a.r}">${a.t}</button>`).join('')}
    </div></div>`;
  stage.appendChild(slide);
  requestAnimationFrame(()=>{ slide.classList.remove('in-right'); slide.classList.add('active'); });
  picked=null; nextBtn.disabled=true;
  slide.querySelector('#answers').addEventListener('click',(e)=>{
    const btn=e.target.closest('.answer'); if(!btn) return;
    slide.querySelectorAll('.answer').forEach(x=>x.classList.remove('selected'));
    btn.classList.add('selected'); picked={role:btn.dataset.role}; nextBtn.disabled=false;
  });
}

nextBtn.addEventListener('click', ()=>{
  if(!picked) return;
  scores[picked.role]=(scores[picked.role]||0)+1; idx++;
  (idx<QUESTIONS.length)?renderQuestion():showResult();
});

/* —Ä–µ–∑—É–ª—å—Ç–∞—Ç */
function showResult(){
  flamesBar.forEach(f=>f.classList.add('on'));
  quizCard.style.display='none'; resultSection.style.display='block';
  const winner=Object.keys(scores).reduce((a,b)=>(scores[a]||0)>(scores[b]||0)?a:b);
  roleEl.textContent=winner; descEl.textContent=ROLES[winner]; drawBadge(winner);
}

/* –±–µ–π–¥–∂ */
function drawBadge(role){
  badgeWrap.innerHTML='';
  const NS='http://www.w3.org/2000/svg';
  const svg=document.createElementNS(NS,'svg'); svg.setAttribute('viewBox','0 0 200 200'); svg.style.width='100%'; svg.style.height='100%';
  const defs=document.createElementNS(NS,'defs');
  const grad=document.createElementNS(NS,'radialGradient'); grad.id='g1';
  grad.innerHTML='<stop offset="0%" stop-color="#fff6d6"/><stop offset="60%" stop-color="#f1c16d"/><stop offset="100%" stop-color="#c58a21"/>';
  defs.appendChild(grad); svg.appendChild(defs);
  const circle=document.createElementNS(NS,'circle'); circle.setAttribute('cx','100'); circle.setAttribute('cy','100'); circle.setAttribute('r','78');
  circle.setAttribute('fill','url(#g1)'); circle.setAttribute('stroke','#8a5a12'); circle.setAttribute('stroke-width','6'); svg.appendChild(circle);
  const ribbon=document.createElementNS(NS,'path'); ribbon.setAttribute('d','M60 170 L100 130 L140 170 L120 170 L100 150 L80 170 Z');
  ribbon.setAttribute('fill','var(--accent)'); ribbon.setAttribute('opacity','.9'); svg.appendChild(ribbon);
  const icons={'–ö–æ—Ä–æ–ª–µ–≤–∞ –∫—Ä–∞—Å–æ—Ç—ã':'üëë','–õ—é–±–∏—Ç–µ–ª—å–Ω–∏—Ü–∞ –∫–æ–º–ø–æ—Ç–∞':'ü•§','–°–∞–º–∞—è –∞–∫—Ç–∏–≤–Ω–∞—è —É—á–∞—Å—Ç–Ω–∏—Ü–∞':'‚≠ê','–¢–∞–π–Ω–∞—è –ø—Ä–æ–∫–∞–∑–Ω–∏—Ü–∞':'üòº','–ò–≥—Ä–æ–∫ –≤ –∫–∞—Ä—Ç—ã –Ω–∞ –∫–∞—Ä–∞–º–µ–ª—å–∫–∏':'üÉè','–°–ø–æ—Ä—Ç—Å–º–µ–Ω–∫–∞':'üèÖ'};
  const icon=document.createElementNS(NS,'text'); icon.setAttribute('x','100'); icon.setAttribute('y','105'); icon.setAttribute('text-anchor','middle'); icon.setAttribute('dominant-baseline','central'); icon.setAttribute('font-size','48'); icon.setAttribute('font-weight','700'); icon.setAttribute('fill','#612e0a'); icon.textContent=icons[role]||'‚≠ê'; svg.appendChild(icon);
  const t=document.createElementNS(NS,'text'); t.setAttribute('x','100'); t.setAttribute('y','188'); t.setAttribute('text-anchor','middle'); t.setAttribute('font-size','12'); t.setAttribute('fill','#5a4635'); t.textContent=role; svg.appendChild(t);
  badgeWrap.appendChild(svg);
}

/* ‚Äî‚Äî‚Äî –∫–æ—Å—Ç—ë—Ä (–ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω—ã–π) ‚Äî‚Äî‚Äî */
let running=false, SP=[], RAF=null, lastT=0, W=0, H=0, fadeTimer=null;
const fireCtx = fctx; const sparksCtx = sctx;
function resizeFX(){ W=innerWidth; H=innerHeight; [fireCanvas,sparksCanvas].forEach(c=>{ c.width=W; c.height=H; c.style.width='100%'; c.style.height='100%'; }); }
window.addEventListener('resize', resizeFX);
function drawFire(ctx,t){
  ctx.clearRect(0,0,W,H);
  for(let i=0;i<28;i++){
    const cx=W*0.5+(Math.sin(t*0.002+i)*W*0.03), cy=H-25-Math.random()*35, rad=40+Math.random()*100;
    ctx.fillStyle=`hsla(${28+Math.random()*12},95%,${55+Math.random()*15}%,${0.05+Math.random()*0.09})`;
    ctx.beginPath(); ctx.arc(cx,cy,rad,0,Math.PI*2); ctx.fill();
  }
  const g=ctx.createRadialGradient(W*0.5,H*0.98,10,W*0.5,H*0.98,Math.min(W,H)*0.7);
  g.addColorStop(0,'rgba(255,170,70,0.25)'); g.addColorStop(1,'rgba(255,170,70,0)'); ctx.fillStyle=g; ctx.fillRect(0,0,W,H);
}
function makeSpark(){ const sx=W*(0.46+Math.random()*0.08), sy=H+Math.random()*30, v0=90+Math.random()*160, vx=(Math.random()*2-1)*22, life=1+Math.random()*1.6, size=1+Math.random()*2.8, hue=28+Math.random()*14, phase=Math.random()*Math.PI*2; return {x:sx,y:sy,vx,vy:-v0,life,maxLife:life,size,hue,phase}; }
function loop(t){
  if(!running) return;
  const dt=Math.min(0.05,(t-(lastT||t))/1000); lastT=t;
  drawFire(fireCtx,t);
  sparksCtx.clearRect(0,0,W,H); sparksCtx.globalCompositeOperation='lighter';
  for(let i=0;i<SP.length;i++){
    const p=SP[i], wind=Math.sin(t*0.001+p.phase)*24, jitter=Math.sin(t*0.006+p.phase)*4;
    p.vx+=(wind*0.4)*dt; p.x+=(p.vx+jitter)*dt; p.y+=p.vy*dt; p.life-=dt;
    const k=Math.max(0,p.life/p.maxLife), size=p.size*(0.6+0.4*k), alpha=Math.min(1,0.18+k*0.9);
    const trail=sparksCtx.createRadialGradient(p.x,p.y+size*2,0,p.x,p.y+size*2,size*6);
    trail.addColorStop(0,`hsla(${p.hue+5},90%,55%,${alpha*0.35})`); trail.addColorStop(1,'hsla(25,90%,50%,0)');
    sparksCtx.fillStyle=trail; sparksCtx.beginPath(); sparksCtx.arc(p.x,p.y+size*2,size*4,0,Math.PI*2); sparksCtx.fill();
    const grad=sparksCtx.createRadialGradient(p.x,p.y,0,p.x,p.y,size*3);
    grad.addColorStop(0,`hsla(50,100%,85%,${alpha})`); grad.addColorStop(0.35,`hsla(${p.hue},95%,60%,${alpha*0.9})`);
    grad.addColorStop(1,`hsla(${p.hue+10},90%,40%,0)`); sparksCtx.fillStyle=grad; sparksCtx.beginPath(); sparksCtx.arc(p.x,p.y,size*2.2,0,Math.PI*2); sparksCtx.fill();
    if(p.life<=0||p.y<-20||p.x<-20||p.x>W+20) SP[i]=makeSpark();
  }
  sparksCtx.globalCompositeOperation='source-over';
  RAF=requestAnimationFrame(loop);
}
function startFX(){ if(running) return; running=true; resizeFX(); SP=Array.from({length:180},makeSpark); fireCanvas.style.display='block'; sparksCanvas.style.display='block'; lastT=0; RAF=requestAnimationFrame(loop); }
function stopFX(){ running=false; if(RAF) cancelAnimationFrame(RAF); fireCanvas.style.display='none'; sparksCanvas.style.display='none'; }
function smoothVolumeTo(target,ms,cb){
  if(fadeTimer) clearInterval(fadeTimer);
  const start=fireAudio.volume, t0=performance.now();
  fadeTimer=setInterval(()=>{ const k=Math.min(1,(performance.now()-t0)/ms);
    fireAudio.volume=start+(target-start)*k; if(k>=1){clearInterval(fadeTimer); fadeTimer=null; cb&&cb();}},16);
}
campSwitchEl.addEventListener('change',(e)=>{
  if(e.target.checked){ document.body.classList.add('camp-night'); startFX(); fireAudio.volume=0; fireAudio.loop=true; fireAudio.play().catch(()=>{})
